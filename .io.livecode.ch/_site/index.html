{% extends "base_livecode.html" %}

{% block title %}Reflective Towers of Interpreters{% endblock %}

{% block content %}
<h2>Black Walkthrough: Debugging</h2>

<div class="live" id="black" data-lib="">
black

</div>

<div class="live" id="s1" data-lib="black">
  (define foo (lambda (f) (lambda (x) (lambda () (f (+ x 1))))))
  (define thunk ((foo 1) 2))
  (thunk)
</div>

<div class="live" id="s2" data-lib="black s1">
  (old-cont 'ok)
</div>

<div class="live" id="s3" data-lib="black s1 s2">
  (EM (load "break.blk"))
  (inspect thunk)
  f
  (set! f (lambda (x) (+ x 2)))
  (exit 'done)
  (thunk)
  (thunk)
</div>

<div class="live" id="s4" data-lib="black s1 s2 s3">
  (define thunk2 ((foo 2) 3))
  (thunk2)
  (old-cont 'ok)
  (EM (load "examples/multn.blk"))
  (thunk2)
  (1 2 3 4)
</div>

<h2>Blond Walkthrough: Tower Semantic Pitfalls</h2>

<div class="live" id="blond" data-lib="">
black

</div>

<div class="live" id="t1" data-lib="blond">
  (load "cont.bl")
  (load "exit.bl")
</div>

<div class="live" id="t2" data-lib="blond t1">
((delta (e r k)
   (begin
     (define re-enter (pushify k))
     (meaning' (define jump k)
               (extend-reified-environment' (k) (list k) r)
               k))))
</div>

<div class="live" id="t3" data-lib="blond t1">
((delta (e r k)
   (define re-enter
     (lambda (v)
       ((pushify k) ((r 're-enter) v))))))
</div>

<div class="live" id="t4" data-lib="blond t2">
  (exit 'up)
  (re-enter 'ok)
</div>

<div class="live" id="t5" data-lib="blond t2 t4">
  1
  2
  3
  (exit 'up)
  (re-enter 'ok)
</div>

<div class="live" id="t6" data-lib="blond t2 t4 t5">
  1
  2
  3
  (jump 'ok)
</div>

<div class="live" id="t7" data-lib="blond t2 t4 t5 t6">
  (exit 'up)
</div>

<div class="live" id="t8" data-lib="blond t2 t4 t5 t6 t7 t3 t3">
</div>

<div class="live" id="t9" data-lib="blond t2 t4 t5 t6 t7 t3 t3 t8">
  (re-enter 'ok)
</div>

<div class="live" id="t10" data-lib="blond t2 t4 t5 t6 t7 t3 t3 t8 t9">
  (exit 'up)
  (exit 'up)
  (exit 'up)
  (exit 'up)
  (exit 'up)
</div>

{% endblock %}
